{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-5132",
        "assignerOrgId": "c09c270a-b464-47c1-9133-acb35b22c19a",
        "state": "PUBLISHED",
        "assignerShortName": "@huntr_ai",
        "dateReserved": "2024-05-19T18:16:51.310Z",
        "datePublished": "2024-06-06T18:30:38.148Z",
        "dateUpdated": "2024-06-06T18:30:38.148Z"
    },
    "containers": {
        "cna": {
            "title": "Business Logic Error in lunary-ai/lunary",
            "providerMetadata": {
                "orgId": "c09c270a-b464-47c1-9133-acb35b22c19a",
                "shortName": "@huntr_ai",
                "dateUpdated": "2024-06-06T18:30:38.148Z"
            },
            "descriptions": [
                {
                    "lang": "en",
                    "value": "In lunary-ai/lunary version 1.2.2, a business logic error allows users to bypass the intended limitations on team member invitations and additions, regardless of their subscription plan. The vulnerability arises due to the lack of validation against the predefined member limits in the SEAT_ALLOWANCE constants during the invitation and joining processes. This issue enables users on any plan, including the free plan, to invite and add more members to a team than allowed, effectively circumventing the system's subscription model. The flaw is located in the backend's handling of user invitations and additions, specifically in the /api/v1/auth/index.ts and /api/v1/users.ts endpoints, where the system fails to check the current number of team members against the allowed limits before proceeding with the invitation and addition operations."
                }
            ],
            "affected": [
                {
                    "vendor": "lunary-ai",
                    "product": "lunary-ai/lunary",
                    "versions": [
                        {
                            "version": "unspecified",
                            "status": "affected",
                            "versionType": "custom",
                            "lessThanOrEqual": "latest"
                        }
                    ]
                }
            ],
            "references": [
                {
                    "url": "https://huntr.com/bounties/1a2d462f-ce25-410c-80f1-10546f963d7c"
                }
            ],
            "metrics": [
                {
                    "cvssV3_0": {
                        "version": "3.0",
                        "attackComplexity": "LOW",
                        "attackVector": "NETWORK",
                        "availabilityImpact": "NONE",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "NONE",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
                        "baseScore": 9.1,
                        "baseSeverity": "CRITICAL"
                    }
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "type": "CWE",
                            "lang": "en",
                            "description": "CWE-840 Business Logic Errors",
                            "cweId": "CWE-840"
                        }
                    ]
                }
            ],
            "source": {
                "advisory": "1a2d462f-ce25-410c-80f1-10546f963d7c",
                "discovery": "EXTERNAL"
            }
        }
    }
}